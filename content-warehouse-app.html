<!DOCTYPE html>
<html lang="vi"><head>

<script class="injected-ffc2e83d85">
(function(){'use strict';function q(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}}function t(b){var c=typeof Symbol!="undefined"&&Symbol.iterator&&b[Symbol.iterator];if(c)return c.call(b);if(typeof b.length=="number")return{next:q(b)};throw Error(String(b)+" is not an iterable or ArrayLike");}var u=typeof Object.defineProperties=="function"?Object.defineProperty:function(b,c,g){if(b==Array.prototype||b==Object.prototype)return b;b[c]=g.value;return b};
function v(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<b.length;++c){var g=b[c];if(g&&g.Math==Math)return g}throw Error("Cannot find global object");}var w=v(this);function x(b,c){if(c)a:{var g=w;b=b.split(".");for(var h=0;h<b.length-1;h++){var l=b[h];if(!(l in g))break a;g=g[l]}b=b[b.length-1];h=g[b];c=c(h);c!=h&&c!=null&&u(g,b,{configurable:!0,writable:!0,value:c})}}
function y(){this.j=!1;this.g=null;this.u=void 0;this.h=1;this.v=this.l=0;this.i=null}function z(b){if(b.j)throw new TypeError("Generator is already running");b.j=!0}y.prototype.o=function(b){this.u=b};function A(b,c){b.i={I:c,J:!0};b.h=b.l||b.v}y.prototype.return=function(b){this.i={return:b};this.h=this.v};function B(b){this.g=new y;this.h=b}function E(b,c){z(b.g);var g=b.g.g;if(g)return F(b,"return"in g?g["return"]:function(h){return{value:h,done:!0}},c,b.g.return);b.g.return(c);return G(b)}
function F(b,c,g,h){try{var l=c.call(b.g.g,g);if(!(l instanceof Object))throw new TypeError("Iterator result "+l+" is not an object");if(!l.done)return b.g.j=!1,l;var m=l.value}catch(f){return b.g.g=null,A(b.g,f),G(b)}b.g.g=null;h.call(b.g,m);return G(b)}function G(b){for(;b.g.h;)try{var c=b.h(b.g);if(c)return b.g.j=!1,{value:c.value,done:!1}}catch(g){b.g.u=void 0,A(b.g,g)}b.g.j=!1;if(b.g.i){c=b.g.i;b.g.i=null;if(c.J)throw c.I;return{value:c.return,done:!0}}return{value:void 0,done:!0}}
function H(b){this.next=function(c){z(b.g);b.g.g?c=F(b,b.g.g.next,c,b.g.o):(b.g.o(c),c=G(b));return c};this.throw=function(c){z(b.g);b.g.g?c=F(b,b.g.g["throw"],c,b.g.o):(A(b.g,c),c=G(b));return c};this.return=function(c){return E(b,c)};this[Symbol.iterator]=function(){return this}}function I(b){function c(h){return b.next(h)}function g(h){return b.throw(h)}return new Promise(function(h,l){function m(f){f.done?h(f.value):Promise.resolve(f.value).then(c,g).then(m,l)}m(b.next())})}
x("Symbol",function(b){function c(m){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new g(h+(m||"")+"_"+l++,m)}function g(m,f){this.g=m;u(this,"description",{configurable:!0,writable:!0,value:f})}if(b)return b;g.prototype.toString=function(){return this.g};var h="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",l=0;return c});
x("Symbol.iterator",function(b){if(b)return b;b=Symbol("Symbol.iterator");u(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return J(q(this))}});return b});function J(b){b={next:b};b[Symbol.iterator]=function(){return this};return b}
x("Promise",function(b){function c(f){this.h=0;this.i=void 0;this.g=[];this.u=!1;var a=this.j();try{f(a.resolve,a.reject)}catch(d){a.reject(d)}}function g(){this.g=null}function h(f){return f instanceof c?f:new c(function(a){a(f)})}if(b)return b;g.prototype.h=function(f){if(this.g==null){this.g=[];var a=this;this.i(function(){a.l()})}this.g.push(f)};var l=w.setTimeout;g.prototype.i=function(f){l(f,0)};g.prototype.l=function(){for(;this.g&&this.g.length;){var f=this.g;this.g=[];for(var a=0;a<f.length;++a){var d=
f[a];f[a]=null;try{d()}catch(e){this.j(e)}}}this.g=null};g.prototype.j=function(f){this.i(function(){throw f;})};c.prototype.j=function(){function f(e){return function(k){d||(d=!0,e.call(a,k))}}var a=this,d=!1;return{resolve:f(this.D),reject:f(this.l)}};c.prototype.D=function(f){if(f===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.G(f);else{a:switch(typeof f){case "object":var a=f!=null;break a;case "function":a=!0;break a;default:a=!1}a?this.C(f):this.o(f)}};
c.prototype.C=function(f){var a=void 0;try{a=f.then}catch(d){this.l(d);return}typeof a=="function"?this.H(a,f):this.o(f)};c.prototype.l=function(f){this.v(2,f)};c.prototype.o=function(f){this.v(1,f)};c.prototype.v=function(f,a){if(this.h!=0)throw Error("Cannot settle("+f+", "+a+"): Promise already settled in state"+this.h);this.h=f;this.i=a;this.h===2&&this.F();this.K()};c.prototype.F=function(){var f=this;l(function(){if(f.B()){var a=w.console;typeof a!=="undefined"&&a.error(f.i)}},1)};c.prototype.B=
function(){if(this.u)return!1;var f=w.CustomEvent,a=w.Event,d=w.dispatchEvent;if(typeof d==="undefined")return!0;typeof f==="function"?f=new f("unhandledrejection",{cancelable:!0}):typeof a==="function"?f=new a("unhandledrejection",{cancelable:!0}):(f=w.document.createEvent("CustomEvent"),f.initCustomEvent("unhandledrejection",!1,!0,f));f.promise=this;f.reason=this.i;return d(f)};c.prototype.K=function(){if(this.g!=null){for(var f=0;f<this.g.length;++f)m.h(this.g[f]);this.g=null}};var m=new g;c.prototype.G=
function(f){var a=this.j();f.A(a.resolve,a.reject)};c.prototype.H=function(f,a){var d=this.j();try{f.call(a,d.resolve,d.reject)}catch(e){d.reject(e)}};c.prototype.then=function(f,a){function d(n,r){return typeof n=="function"?function(C){try{e(n(C))}catch(D){k(D)}}:r}var e,k,p=new c(function(n,r){e=n;k=r});this.A(d(f,e),d(a,k));return p};c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.A=function(f,a){function d(){switch(e.h){case 1:f(e.i);break;case 2:a(e.i);break;default:throw Error("Unexpected state: "+
e.h);}}var e=this;this.g==null?m.h(d):this.g.push(d);this.u=!0};c.resolve=h;c.reject=function(f){return new c(function(a,d){d(f)})};c.race=function(f){return new c(function(a,d){for(var e=t(f),k=e.next();!k.done;k=e.next())h(k.value).A(a,d)})};c.all=function(f){var a=t(f),d=a.next();return d.done?h([]):new c(function(e,k){function p(C){return function(D){n[C]=D;r--;r==0&&e(n)}}var n=[],r=0;do n.push(void 0),r++,h(d.value).A(p(n.length-1),k),d=a.next();while(!d.done)})};return c});
function K(b,c){return Object.prototype.hasOwnProperty.call(b,c)}x("Object.is",function(b){return b?b:function(c,g){return c===g?c!==0||1/c===1/g:c!==c&&g!==g}});x("Array.prototype.includes",function(b){return b?b:function(c,g){var h=this;h instanceof String&&(h=String(h));var l=h.length;g=g||0;for(g<0&&(g=Math.max(g+l,0));g<l;g++){var m=h[g];if(m===c||Object.is(m,c))return!0}return!1}});
x("String.prototype.includes",function(b){return b?b:function(c,g){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(c,g||0)!==-1}});
x("WeakMap",function(b){function c(d){this.g=(a+=Math.random()+1).toString();if(d){d=t(d);for(var e;!(e=d.next()).done;)e=e.value,this.set(e[0],e[1])}}function g(){}function h(d){var e=typeof d;return e==="object"&&d!==null||e==="function"}function l(d){if(!K(d,f)){var e=new g;u(d,f,{value:e})}}function m(d){var e=Object[d];e&&(Object[d]=function(k){if(k instanceof g)return k;Object.isExtensible(k)&&l(k);return e(k)})}if(function(){if(!b||!Object.seal)return!1;try{var d=Object.seal({}),e=Object.seal({}),
k=new b([[d,2],[e,3]]);if(k.get(d)!=2||k.get(e)!=3)return!1;k.delete(d);k.set(e,4);return!k.has(d)&&k.get(e)==4}catch(p){return!1}}())return b;var f="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var a=0;c.prototype.set=function(d,e){if(!h(d))throw Error("Invalid WeakMap key");l(d);if(!K(d,f))throw Error("WeakMap key fail: "+d);d[f][this.g]=e;return this};c.prototype.get=function(d){return h(d)&&K(d,f)?d[f][this.g]:void 0};c.prototype.has=function(d){return h(d)&&K(d,
f)&&K(d[f],this.g)};c.prototype.delete=function(d){return h(d)&&K(d,f)&&K(d[f],this.g)?delete d[f][this.g]:!1};return c});
x("Map",function(b){function c(){var a={};return a.m=a.next=a.head=a}function g(a,d){var e=a[1];return J(function(){if(e){for(;e.head!=a[1];)e=e.m;for(;e.next!=e.head;)return e=e.next,{done:!1,value:d(e)};e=null}return{done:!0,value:void 0}})}function h(a,d){var e=d&&typeof d;e=="object"||e=="function"?m.has(d)?e=m.get(d):(e=""+ ++f,m.set(d,e)):e="p_"+d;var k=a[0][e];if(k&&K(a[0],e))for(a=0;a<k.length;a++){var p=k[a];if(d!==d&&p.key!==p.key||d===p.key)return{id:e,list:k,index:a,entry:p}}return{id:e,
list:k,index:-1,entry:void 0}}function l(a){this[0]={};this[1]=c();this.size=0;if(a){a=t(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||typeof b!="function"||!b.prototype.entries||typeof Object.seal!="function")return!1;try{var a=Object.seal({x:4}),d=new b(t([[a,"s"]]));if(d.get(a)!="s"||d.size!=1||d.get({x:4})||d.set({x:4},"t")!=d||d.size!=2)return!1;var e=d.entries(),k=e.next();if(k.done||k.value[0]!=a||k.value[1]!="s")return!1;k=e.next();return k.done||k.value[0].x!=
4||k.value[1]!="t"||!e.next().done?!1:!0}catch(p){return!1}}())return b;var m=new WeakMap;l.prototype.set=function(a,d){a=a===0?0:a;var e=h(this,a);e.list||(e.list=this[0][e.id]=[]);e.entry?e.entry.value=d:(e.entry={next:this[1],m:this[1].m,head:this[1],key:a,value:d},e.list.push(e.entry),this[1].m.next=e.entry,this[1].m=e.entry,this.size++);return this};l.prototype.delete=function(a){a=h(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this[0][a.id],a.entry.m.next=a.entry.next,
a.entry.next.m=a.entry.m,a.entry.head=null,this.size--,!0):!1};l.prototype.clear=function(){this[0]={};this[1]=this[1].m=c();this.size=0};l.prototype.has=function(a){return!!h(this,a).entry};l.prototype.get=function(a){return(a=h(this,a).entry)&&a.value};l.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};l.prototype.keys=function(){return g(this,function(a){return a.key})};l.prototype.values=function(){return g(this,function(a){return a.value})};l.prototype.forEach=
function(a,d){for(var e=this.entries(),k;!(k=e.next()).done;)k=k.value,a.call(d,k[1],k[0],this)};l.prototype[Symbol.iterator]=l.prototype.entries;var f=0;return l});
x("Set",function(b){function c(g){this.g=new Map;if(g){g=t(g);for(var h;!(h=g.next()).done;)this.add(h.value)}this.size=this.g.size}if(function(){if(!b||typeof b!="function"||!b.prototype.entries||typeof Object.seal!="function")return!1;try{var g=Object.seal({x:4}),h=new b(t([g]));if(!h.has(g)||h.size!=1||h.add(g)!=h||h.size!=1||h.add({x:4})!=h||h.size!=2)return!1;var l=h.entries(),m=l.next();if(m.done||m.value[0]!=g||m.value[1]!=g)return!1;m=l.next();return m.done||m.value[0]==g||m.value[0].x!=4||
m.value[1]!=m.value[0]?!1:l.next().done}catch(f){return!1}}())return b;c.prototype.add=function(g){g=g===0?0:g;this.g.set(g,g);this.size=this.g.size;return this};c.prototype.delete=function(g){g=this.g.delete(g);this.size=this.g.size;return g};c.prototype.clear=function(){this.g.clear();this.size=0};c.prototype.has=function(g){return this.g.has(g)};c.prototype.entries=function(){return this.g.entries()};c.prototype.values=function(){return this.g.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=
c.prototype.values;c.prototype.forEach=function(g,h){var l=this;this.g.forEach(function(m){return g.call(h,m,m,l)})};return c});(function(){function b(){return m?Promise.resolve(m):f?f:f=fetch("https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json").then(function(a){if(!a.ok)throw Error("HTTP error! status: "+a.status+" fetching https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json");return a.json()}).then(function(a){if(!Array.isArray(a))throw new TypeError("Fetched icon names from https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json is not an array.");
return m=a}).catch(function(a){console.error("IconChecker: Failed to load valid icon names from https://www.gstatic.com/bard-maui/resources/material-design-icon-names.804824289.json.",a);f=null;throw a;})}function c(a){var d,e,k,p;return I(new H(new B(function(n){switch(n.h){case 1:d=(a.textContent||"").trim();if(!d||a.classList.contains("js-replaced-missing-icon")&&d==="radio_button_unchecked")return n.return();e=window.getComputedStyle(a);if(e.display==="none"||e.visibility==="hidden")return n.return();
n.l=2;var r=b();n.h=4;return{value:r};case 4:k=n.u;n.h=3;n.l=0;break;case 2:return n.l=0,n.i=null,console.warn('IconChecker: Skipping check for icon "'+d+'" as valid names could not be loaded.'),n.return();case 3:(p=k.includes(d))?a.classList.contains("js-replaced-missing-icon")&&a.classList.remove("js-replaced-missing-icon"):d==="radio_button_unchecked"&&a.classList.contains("js-replaced-missing-icon")||(a.textContent="radio_button_unchecked",a.classList.add("js-replaced-missing-icon")),n.h=0}})))}
function g(a){a=a===void 0?document.body:a;a.querySelectorAll(l).forEach(function(d){c(d)})}function h(){b().catch(function(){});document.fonts.ready.then(function(){requestAnimationFrame(function(){g(document.body);(new MutationObserver(function(a){var d=new Set;a=t(a);for(var e=a.next();!e.done;e=a.next())if(e=e.value,e.type==="childList")e.addedNodes.forEach(function(p){p.nodeType===Node.ELEMENT_NODE&&(p.matches(l)&&d.add(p),p.querySelectorAll(l).forEach(function(n){d.add(n)}))});else if(e.type===
"attributes"&&e.attributeName==="class"){var k=e.target;e.target.nodeType===Node.ELEMENT_NODE&&k.matches(l)&&d.add(k)}else e.type==="characterData"&&e.target.parentNode&&(e=e.target.parentNode,e.nodeType===Node.ELEMENT_NODE&&e.matches(l)&&d.add(e));d.size>0&&setTimeout(function(){d.forEach(function(p){c(p)})},500)})).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"],characterData:!0})})}).catch(function(a){console.error("IconChecker: Font loading error. Scanning icons anyway.",
a);requestAnimationFrame(function(){g(document.body)})})}var l=["material-icons","material-symbols-outlined","material-symbols-rounded","material-symbols-sharp"].map(function(a){return"."+a}).join(","),m=null,f=null;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){h()}):h()})();}).call(this);

</script>

<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>Content Warehouse - Qu·∫£n l√Ω T√†i nguy√™n Video</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&amp;family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
<script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        bgDark: '#0b0e14',
                        panelDark: '#161b26',
                        borderDark: '#232d3f',
                        accentPrimary: '#3b82f6', // Blue for Text/structure
                        accentSecondary: '#f59e0b', // Orange for Voice/Audio
                        accentTertiary: '#10b981', // Green for Finish
                        accentQuaternary: '#ec4899', // Pink for Images
                    }
                }
            }
        }
    </script>
<style>
        body {
            background-color: #0b0e14;
            color: #cbd5e1;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #0f172a; 
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #334155; 
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #475569; 
        }
        
        .stage-card {
            transition: all 0.2s ease-in-out;
        }
        .stage-card:focus-within {
            border-color: #3b82f6;
            background-color: #1e293b;
        }

        /* Status Indicators */
        .status-dot {
            height: 8px;
            width: 8px;
            border-radius: 50%;
            display: inline-block;
        }
        .status-empty { background-color: #334155; }
        .status-filled { background-color: #10b981; box-shadow: 0 0 8px rgba(16, 185, 129, 0.4); }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:Inter, sans-serif;font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:JetBrains Mono, monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.pointer-events-none{pointer-events:none}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.z-0{z-index:0}.z-10{z-index:10}.z-20{z-index:20}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-3{margin-top:0.75rem}.ml-auto{margin-left:auto}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-16{height:4rem}.h-3{height:0.75rem}.h-32{height:8rem}.h-4{height:1rem}.h-44{height:11rem}.h-8{height:2rem}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.h-1\.5{height:0.375rem}.min-h-\[120px\]{min-height:120px}.min-h-\[200px\]{min-height:200px}.w-3{width:0.75rem}.w-4{width:1rem}.w-8{width:2rem}.w-80{width:20rem}.w-96{width:24rem}.w-full{width:100%}.w-px{width:1px}.w-1\.5{width:0.375rem}.w-40{width:10rem}.max-w-6xl{max-width:72rem}.flex-1{flex:1 1 0%}.cursor-pointer{cursor:pointer}.resize-none{resize:none}.resize-y{resize:vertical}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-8 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded{border-radius:0.25rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-none{border-style:none}.border-accentPrimary\/30{border-color:rgb(59 130 246 / 0.3)}.border-accentPrimary\/50{border-color:rgb(59 130 246 / 0.5)}.border-borderDark{--tw-border-opacity:1;border-color:rgb(35 45 63 / var(--tw-border-opacity, 1))}.border-slate-600{--tw-border-opacity:1;border-color:rgb(71 85 105 / var(--tw-border-opacity, 1))}.border-slate-700{--tw-border-opacity:1;border-color:rgb(51 65 85 / var(--tw-border-opacity, 1))}.bg-\[\#0f1520\]{--tw-bg-opacity:1;background-color:rgb(15 21 32 / var(--tw-bg-opacity, 1))}.bg-accentPrimary{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-accentPrimary\/10{background-color:rgb(59 130 246 / 0.1)}.bg-bgDark{--tw-bg-opacity:1;background-color:rgb(11 14 20 / var(--tw-bg-opacity, 1))}.bg-bgDark\/30{background-color:rgb(11 14 20 / 0.3)}.bg-bgDark\/50{background-color:rgb(11 14 20 / 0.5)}.bg-bgDark\/95{background-color:rgb(11 14 20 / 0.95)}.bg-borderDark{--tw-bg-opacity:1;background-color:rgb(35 45 63 / var(--tw-bg-opacity, 1))}.bg-panelDark{--tw-bg-opacity:1;background-color:rgb(22 27 38 / var(--tw-bg-opacity, 1))}.bg-panelDark\/80{background-color:rgb(22 27 38 / 0.8)}.bg-slate-600{--tw-bg-opacity:1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.bg-slate-700{--tw-bg-opacity:1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.bg-slate-800{--tw-bg-opacity:1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.bg-slate-800\/50{background-color:rgb(30 41 59 / 0.5)}.bg-transparent{background-color:transparent}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity:1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-pink-500{--tw-bg-opacity:1;background-color:rgb(236 72 153 / var(--tw-bg-opacity, 1))}.bg-opacity-20{--tw-bg-opacity:0.2}.bg-\[url\(\'https\:\/\/grainy-gradients\.vercel\.app\/noise\.svg\'\)\]{background-image:url('https://grainy-gradients.vercel.app/noise.svg')}.bg-cover{background-size:cover}.bg-center{background-position:center}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-8{padding-top:2rem;padding-bottom:2rem}.pb-10{padding-bottom:2.5rem}.pb-20{padding-bottom:5rem}.text-center{text-align:center}.font-mono{font-family:JetBrains Mono, monospace}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[10px\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-\[14px\]{font-size:14px}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.tracking-tight{letter-spacing:-0.025em}.text-accentPrimary{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-accentQuaternary{--tw-text-opacity:1;color:rgb(236 72 153 / var(--tw-text-opacity, 1))}.text-accentSecondary{--tw-text-opacity:1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-accentTertiary{--tw-text-opacity:1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.text-purple-400{--tw-text-opacity:1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.text-red-400{--tw-text-opacity:1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.text-slate-200{--tw-text-opacity:1;color:rgb(226 232 240 / var(--tw-text-opacity, 1))}.text-slate-300{--tw-text-opacity:1;color:rgb(203 213 225 / var(--tw-text-opacity, 1))}.text-slate-400{--tw-text-opacity:1;color:rgb(148 163 184 / var(--tw-text-opacity, 1))}.text-slate-500{--tw-text-opacity:1;color:rgb(100 116 139 / var(--tw-text-opacity, 1))}.text-slate-600{--tw-text-opacity:1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.placeholder-slate-600::placeholder{--tw-placeholder-opacity:1;color:rgb(71 85 105 / var(--tw-placeholder-opacity, 1))}.opacity-20{opacity:0.2}.shadow-\[0_0_20px_rgba\(59\2c 130\2c 246\2c 0\.05\)\]{--tw-shadow:0 0 20px rgba(59,130,246,0.05);--tw-shadow-colored:0 0 20px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:border-accentPrimary:hover{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.hover\:border-slate-500:hover{--tw-border-opacity:1;border-color:rgb(100 116 139 / var(--tw-border-opacity, 1))}.hover\:border-slate-600:hover{--tw-border-opacity:1;border-color:rgb(71 85 105 / var(--tw-border-opacity, 1))}.hover\:bg-accentPrimary:hover{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:bg-red-500\/10:hover{background-color:rgb(239 68 68 / 0.1)}.hover\:bg-slate-600:hover{--tw-bg-opacity:1;background-color:rgb(71 85 105 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-700:hover{--tw-bg-opacity:1;background-color:rgb(51 65 85 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-800:hover{--tw-bg-opacity:1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.hover\:bg-slate-800\/50:hover{background-color:rgb(30 41 59 / 0.5)}.hover\:bg-white:hover{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.hover\:text-accentSecondary:hover{--tw-text-opacity:1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.hover\:text-accentTertiary:hover{--tw-text-opacity:1;color:rgb(16 185 129 / var(--tw-text-opacity, 1))}.hover\:text-black:hover{--tw-text-opacity:1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.focus\:border-accentPrimary:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-0:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-accentPrimary:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}.group:hover .group-hover\:border-accentPrimary{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.group:hover .group-hover\:border-accentSecondary{--tw-border-opacity:1;border-color:rgb(245 158 11 / var(--tw-border-opacity, 1))}.group:hover .group-hover\:border-accentTertiary{--tw-border-opacity:1;border-color:rgb(16 185 129 / var(--tw-border-opacity, 1))}.group:hover .group-hover\:border-slate-500{--tw-border-opacity:1;border-color:rgb(100 116 139 / var(--tw-border-opacity, 1))}.group\/drop:hover .group-hover\/drop\:text-accentPrimary{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.group\/drop:hover .group-hover\/drop\:text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-accentPrimary{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.group:hover .group-hover\:text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}</style></head>
<body class="flex h-screen overflow-hidden text-sm">
<!-- SIDEBAR: Project List (The "Queue") -->
<aside class="w-80 bg-panelDark border-r border-borderDark flex flex-col z-20 shadow-xl">
<div class="p-4 border-b border-borderDark flex justify-between items-center bg-bgDark/50">
<div>
<h1 class="font-bold text-white text-base tracking-tight flex items-center gap-2">
<span class="material-symbols-outlined text-accentPrimary">inventory_2</span>
                    KHO T√ÄI NGUY√äN
                </h1>
<p class="text-xs text-slate-500 mt-1">Qu·∫£n l√Ω file t·ª´ng giai ƒëo·∫°n</p>
</div>
<button class="w-8 h-8 rounded bg-accentPrimary/10 text-accentPrimary hover:bg-accentPrimary hover:text-white transition flex items-center justify-center" onclick="createNewProject()" title="Th√™m Project M·ªõi">
<span class="material-symbols-outlined text-lg">add</span>
</button>
</div>
<!-- Filters / Stats -->
<div class="px-4 py-3 grid grid-cols-3 gap-2 border-b border-borderDark text-[10px] uppercase font-semibold text-slate-500">
<div class="text-center cursor-pointer hover:text-white transition">To√†n b·ªô (<span id="count-all">2</span>)</div>
<div class="text-center cursor-pointer hover:text-accentSecondary transition">ƒêang l√†m (<span id="count-active">1</span>)</div>
<div class="text-center cursor-pointer hover:text-accentTertiary transition">Xong (<span id="count-done">1</span>)</div>
</div>
<!-- Project List Container -->
<div class="flex-1 overflow-y-auto custom-scrollbar p-3 space-y-2" id="project-list"></div>
<!-- Sidebar Footer: Sync Data -->
<div class="p-4 border-t border-borderDark bg-bgDark/30 space-y-2">
<button class="w-full flex items-center justify-center gap-2 py-2.5 rounded-lg border border-accentPrimary text-accentPrimary hover:bg-accentPrimary hover:text-white transition text-xs font-semibold group" onclick="saveToGoogleSheets()">
<span class="material-symbols-outlined text-sm group-hover:text-white transition">save</span>
            L∆∞u D·ªØ Li·ªáu
        </button>
<button class="w-full flex items-center justify-center gap-2 py-2.5 rounded-lg border border-slate-700 text-slate-400 hover:text-white hover:bg-slate-800 hover:border-slate-500 transition text-xs font-semibold group" onclick="downloadSourceCode()">
<span class="material-symbols-outlined text-sm group-hover:text-accentPrimary transition">code</span>
            Xu·∫•t M√£ Ngu·ªìn
        </button>
<p class="text-[10px] text-center text-slate-600 mt-2">üíæ D·ªØ li·ªáu t·ª± ƒë·ªông l∆∞u khi b·∫°n nh·∫≠p</p>
</div>
<p class="text-[10px] text-center text-slate-600 mt-2">T·∫£i file .html n√†y v·ªÅ ƒë·ªÉ ch·∫°y offline</p>
</div>
</aside>
<!-- MAIN CONTENT: The Workstation -->
<main class="flex-1 flex flex-col relative bg-bgDark bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-opacity-20">
<!-- Empty State (When no project selected) -->
<div class="absolute inset-0 flex flex-col items-center justify-center text-slate-600 z-0" id="empty-state">
<span class="material-symbols-outlined text-6xl mb-4 opacity-20">topic</span>
<p class="text-lg font-medium">Ch·ªçn ho·∫∑c t·∫°o m·ªôt d·ª± √°n ƒë·ªÉ b·∫Øt ƒë·∫ßu l∆∞u tr·ªØ</p>
</div>
<!-- Workspace (Hidden by default) -->
<div class="flex flex-col h-full hidden z-10 bg-bgDark/95 backdrop-blur-sm" id="workspace">
<!-- Workspace Header -->
<header class="h-16 border-b border-borderDark flex items-center justify-between px-6 bg-panelDark/80">
<div class="flex items-center gap-4">
<div class="w-3 h-3 rounded-full bg-slate-600" id="ws-status-indicator"></div>
<div>
<input class="bg-transparent border-none text-lg font-bold text-white focus:ring-0 focus:outline-none placeholder-slate-600 w-96" id="ws-project-title" type="text" value="Project Title">
<p class="text-xs text-slate-400 font-mono" id="ws-project-id">ID: #---</p>
</div>
</div>
<div class="flex items-center gap-3">
<div class="flex items-center gap-1 text-xs text-slate-400 bg-slate-800/50 px-3 py-1.5 rounded-full border border-slate-700">
<span class="material-symbols-outlined text-sm">folder</span>
<span>Ti·∫øn ƒë·ªô l∆∞u tr·ªØ: <span class="text-white font-bold" id="ws-progress-text">0%</span></span>
</div>
<button class="p-2 text-red-400 hover:bg-red-500/10 rounded-lg transition" onclick="deleteCurrentProject()" title="X√≥a d·ª± √°n">
<span class="material-symbols-outlined">delete</span>
</button>
</div>
</header>
<!-- Scrollable Asset Zones -->
<div class="flex-1 overflow-y-auto custom-scrollbar p-8">
<div class="max-w-6xl mx-auto space-y-8 pb-20">
<!-- GIAI ƒêO·∫†N 1: SOURCE -->
<section class="group">
<div class="flex items-center gap-3 mb-4">
<div class="w-8 h-8 rounded bg-slate-800 border border-slate-700 flex items-center justify-center text-slate-400 group-hover:text-white group-hover:border-slate-500 transition">1</div>
<h2 class="text-lg font-semibold text-slate-200">Video Ngu·ªìn &amp; Download</h2>
<span class="h-px flex-1 bg-borderDark"></span>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- File Ngu·ªìn -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-5 relative overflow-hidden">
<label class="block text-xs font-bold text-slate-400 uppercase mb-3 flex justify-between">
<span>Link Video Ngu·ªìn</span>
<span class="material-symbols-outlined text-sm status-indicator" id="status-icon-source">radio_button_unchecked</span>
</label>
<div class="space-y-3">
<input class="w-full bg-bgDark border border-slate-700 rounded-lg px-4 py-3 text-sm text-white focus:border-accentPrimary focus:outline-none" id="link-source" oninput="updateSourceLink(this.value)" placeholder="D√°n link video (TikTok/YouTube/Google Drive)..." type="text">
<div class="flex gap-2">
<button class="flex-1 py-2 rounded border border-accentPrimary text-accentPrimary hover:bg-accentPrimary hover:text-white text-xs transition flex items-center justify-center gap-2" onclick="openVideoLink()" id="btn-open-video">
<span class="material-symbols-outlined text-sm">open_in_new</span>
<span>M·ªü Video</span>
</button>
<button class="flex-1 py-2 rounded border border-slate-700 text-slate-400 hover:bg-slate-700 hover:text-white text-xs transition flex items-center justify-center gap-2" onclick="clearVideoLink()">
<span class="material-symbols-outlined text-sm">close</span>
<span>X√≥a Link</span>
</button>
</div>
<div class="text-[10px] text-slate-600 text-center" id="video-status">Ch∆∞a c√≥ link video</div>
</div>
</div>
<!-- Ghi ch√∫ nhanh -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-5">
<label class="block text-xs font-bold text-slate-400 uppercase mb-3">Ghi ch√∫ v·ªÅ ngu·ªìn (Ideas/Highlights)</label>
<textarea class="w-full h-44 bg-bgDark border border-slate-700 rounded-lg p-3 text-sm text-slate-300 focus:border-accentPrimary focus:outline-none resize-none custom-scrollbar" id="note-source" oninput="updateData('sourceNote', this.value)" placeholder="Note l·∫°i ƒëo·∫°n hay, gi√¢y th·ª© bao nhi√™u, √Ω t∆∞·ªüng edit..."></textarea>
</div>
</div>
</section>
<!-- GIAI ƒêO·∫†N 2: TEXT/SCRIPT -->
<section class="group">
<div class="flex items-center gap-3 mb-4">
<div class="w-8 h-8 rounded bg-slate-800 border border-slate-700 flex items-center justify-center text-accentPrimary group-hover:border-accentPrimary transition">2</div>
<h2 class="text-lg font-semibold text-slate-200">K·ªãch B·∫£n (Text)</h2>
<span class="h-px flex-1 bg-borderDark"></span>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
<!-- Text G·ªëc -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-5 flex flex-col">
<div class="flex justify-between items-center mb-3">
<label class="text-xs font-bold text-slate-400 uppercase">Transcript (Text tr√≠ch xu·∫•t)</label>
<div class="flex gap-2">
<button class="text-[10px] bg-purple-600 hover:bg-purple-700 text-white px-2 py-1 rounded transition flex items-center gap-1" onclick="triggerTextFileUpload()" title="M·ªü file .txt t·ª´ m√°y">
<span class="material-symbols-outlined text-xs">upload_file</span>
<span>M·ªü File</span>
</button>
<button class="text-[10px] bg-accentSecondary hover:bg-orange-600 text-white px-2 py-1 rounded transition flex items-center gap-1" onclick="openDownSubWithLink()" title="L·∫•y link video v√† m·ªü DownSub">
<span class="material-symbols-outlined text-xs">link</span>
<span>DownSub+Link</span>
</button>
<button class="text-[10px] bg-slate-700 hover:bg-white hover:text-black px-2 py-1 rounded transition" onclick="copyToClipboard('text-transcript')">COPY</button>
</div>
</div>
<input type="file" id="text-file-input" accept=".txt,.srt,.vtt" class="hidden" onchange="handleTextFileUpload(this)">
<textarea class="flex-1 min-h-[200px] max-h-[400px] bg-bgDark border border-slate-700 rounded-lg p-3 text-sm text-slate-400 font-mono focus:border-accentPrimary focus:outline-none overflow-y-auto custom-scrollbar" id="text-transcript" oninput="autoSaveTranscript(this.value)" onchange="updateData('transcript', this.value)" placeholder="D√°n text tr√≠ch xu·∫•t, ho·∫∑c click 'M·ªü File' ƒë·ªÉ t·∫£i file .txt t·ª´ m√°y..."></textarea>
</div>
<!-- Text AI -->
<div class="stage-card bg-panelDark border border-accentPrimary/30 rounded-xl p-5 flex flex-col shadow-[0_0_20px_rgba(59,130,246,0.05)]">
<div class="flex justify-between items-center mb-3">
<label class="text-xs font-bold text-accentPrimary uppercase flex items-center gap-2">
<span class="material-symbols-outlined text-sm js-replaced-missing-icon">radio_button_unchecked</span>
                                        AI Rewrite (K·ªãch b·∫£n m·ªõi)
                                    </label>
<div class="flex gap-2">
<span class="status-dot status-empty" id="status-dot-script"></span>
<button class="text-[10px] bg-accentPrimary hover:bg-blue-600 text-white px-2 py-1 rounded transition" onclick="copyToClipboard('text-ai')">COPY</button>
</div>
</div>
<textarea class="flex-1 min-h-[200px] bg-[#0f1520] border border-accentPrimary/50 rounded-lg p-3 text-sm text-white font-mono focus:ring-1 focus:ring-accentPrimary focus:outline-none resize-y custom-scrollbar" id="text-ai" oninput="updateData('aiScript', this.value)" placeholder="D√°n k·ªãch b·∫£n ƒë√£ ƒë∆∞·ª£c AI vi·∫øt l·∫°i v√†o ƒë√¢y..."></textarea>
</div>
</div>
</section>
<!-- GIAI ƒêO·∫†N 3: ASSETS -->
<section class="group">
<div class="flex items-center gap-3 mb-4">
<div class="w-8 h-8 rounded bg-slate-800 border border-slate-700 flex items-center justify-center text-accentSecondary group-hover:border-accentSecondary transition">3</div>
<h2 class="text-lg font-semibold text-slate-200">T√†i Nguy√™n Multimedia</h2>
<span class="h-px flex-1 bg-borderDark"></span>
</div>
<div class="grid grid-cols-1 md:grid-cols-3 gap-6">
<!-- Image Assets -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-4 flex flex-col">
<label class="text-xs font-bold text-accentQuaternary uppercase mb-3 flex items-center gap-2">
<span class="material-symbols-outlined text-sm">image</span>
                                    H√¨nh ·∫£nh (Gen/Veo)
                                </label>
<div class="bg-bgDark rounded border border-dashed border-slate-700 p-2 min-h-[120px] mb-2" id="container-images">
<!-- List of uploaded images -->
<div class="text-center py-8 text-xs text-slate-600 pointer-events-none">
                                        Ch∆∞a c√≥ ·∫£nh n√†o
                                    </div>
</div>
<button class="w-full py-2 rounded border border-slate-700 text-slate-400 hover:text-white hover:bg-slate-700 hover:border-slate-500 text-xs transition flex items-center justify-center gap-2" onclick="triggerFileUpload('image')">
<span class="material-symbols-outlined text-sm">add_photo_alternate</span>
                                    Th√™m ·∫£nh v√†o kho
                                </button>
<input accept="image/*" class="hidden" id="input-image" multiple="" onchange="handleFileSelect('image', this)" type="file">
</div>
<!-- Voice Assets -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-4 flex flex-col">
<label class="text-xs font-bold text-accentSecondary uppercase mb-3 flex items-center gap-2">
<span class="material-symbols-outlined text-sm">mic</span>
                                    Voice AI (Vbe)
                                </label>
<div class="bg-bgDark rounded border border-dashed border-slate-700 p-2 min-h-[120px] mb-2 flex flex-col gap-2" id="container-voice">
<div class="text-center py-8 text-xs text-slate-600 pointer-events-none">
                                        Ch∆∞a c√≥ file √¢m thanh
                                    </div>
</div>
<button class="w-full py-2 rounded border border-slate-700 text-slate-400 hover:text-white hover:bg-slate-700 hover:border-slate-500 text-xs transition flex items-center justify-center gap-2" onclick="triggerFileUpload('voice')">
<span class="material-symbols-outlined text-sm">upload_file</span>
                                    Th√™m file Voice
                                </button>
<input accept="audio/*" class="hidden" id="input-voice" onchange="handleFileSelect('voice', this)" type="file">
</div>
<!-- Music Assets -->
<div class="stage-card bg-panelDark border border-borderDark rounded-xl p-4 flex flex-col">
<label class="text-xs font-bold text-purple-400 uppercase mb-3 flex items-center gap-2">
<span class="material-symbols-outlined text-sm">music_note</span>
                                    Nh·∫°c n·ªÅn (Trending)
                                </label>
<div class="bg-bgDark rounded border border-dashed border-slate-700 p-2 min-h-[120px] mb-2 flex flex-col gap-2" id="container-music">
<div class="text-center py-8 text-xs text-slate-600 pointer-events-none">
                                        Ch∆∞a c√≥ nh·∫°c
                                    </div>
</div>
<button class="w-full py-2 rounded border border-slate-700 text-slate-400 hover:text-white hover:bg-slate-700 hover:border-slate-500 text-xs transition flex items-center justify-center gap-2" onclick="triggerFileUpload('music')">
<span class="material-symbols-outlined text-sm">library_music</span>
                                    Th√™m nh·∫°c
                                </button>
<input accept="audio/*" class="hidden" id="input-music" onchange="handleFileSelect('music', this)" type="file">
</div>
</div>
</section>
<!-- GIAI ƒêO·∫†N 4: FINAL -->
<section class="group pb-10">
<div class="flex items-center gap-3 mb-4">
<div class="w-8 h-8 rounded bg-slate-800 border border-slate-700 flex items-center justify-center text-accentTertiary group-hover:border-accentTertiary transition">4</div>
<h2 class="text-lg font-semibold text-slate-200">Ho√†n Thi·ªán (Edit)</h2>
<span class="h-px flex-1 bg-borderDark"></span>
</div>
<div class="bg-panelDark border border-borderDark rounded-xl p-6 flex items-center justify-between">
<div>
<h3 class="font-bold text-white mb-1">Tr·∫°ng th√°i cu·ªëi c√πng</h3>
<p class="text-xs text-slate-500">ƒê√°nh d·∫•u khi b·∫°n ƒë√£ ƒë·∫©y to√†n b·ªô t√†i nguy√™n sang CapCut v√† ho√†n t·∫•t edit.</p>
</div>
<div class="flex items-center gap-4">
<div class="flex items-center gap-2">
<input class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-accentPrimary focus:ring-0" id="check-sent" onchange="updateData('sentToCapcut', this.checked)" type="checkbox">
<label class="text-sm text-slate-300" for="check-sent">ƒê√£ g·ª≠i sang CapCut</label>
</div>
<div class="h-8 w-px bg-slate-700"></div>
<button class="px-6 py-2.5 rounded-lg font-bold text-sm transition flex items-center gap-2 bg-slate-700 text-slate-400 hover:bg-slate-600" id="btn-complete" onclick="toggleComplete()">
<span class="material-symbols-outlined">check_circle</span>
<span id="btn-complete-text">ƒê√°nh d·∫•u Ho√†n th√†nh</span>
</button>
</div>
</div>
</section>
</div>
</div>
</div>
</main>
<script>
        // --- STATE MANAGEMENT ---
        let projects = [];
        let activeProjectId = null;
        let transcriptSaveTimeout = null;

        // --- LOCAL STORAGE FUNCTIONS (REMOVED - Only use Google Sheets) ---

        // --- GOOGLE SHEETS INTEGRATION ---
        const SHEETS_ID = '103qcXD2bIsPCULFYxtRv9oNJ5BLvaysb6oyKY2PTRDo';
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbygf3KuLbo-tS3TL_9ScMNZWZs6UNiKJDuya3GQTz7rdU1jDElBtnZRuawS31HaDuNPRg/exec';

        async function saveToGoogleSheets() {
            try {
                showNotification('‚ü≥ ƒêang l∆∞u l√™n Google Sheet...', 'info');
                
                // Prepare project data WITHOUT assets (·∫£nh/video)
                const projectsForSheet = projects.map(p => ({
                    id: p.id,
                    title: p.title,
                    created: p.created,
                    isComplete: p.isComplete,
                    sourceLink: p.data.sourceLink,
                    sourceNote: p.data.sourceNote,
                    transcript: p.data.transcript,
                    aiScript: p.data.aiScript,
                    sentToCapcut: p.data.sentToCapcut,
                    imageCount: p.data.images.length,
                    voiceCount: p.data.voice.length,
                    musicCount: p.data.music.length
                }));
                
                // Prepare all assets (·∫£nh/video/audio) - m·ªói c√°i 1 h√†ng
                const assetsForSheet = [];
                projects.forEach(p => {
                    // Add images
                    p.data.images.forEach((img, idx) => {
                        assetsForSheet.push({
                            projectId: p.id,
                            assetType: 'image',
                            index: idx,
                            name: img.name,
                            mimeType: img.type,
                            data: img.data
                        });
                    });
                    // Add voice
                    p.data.voice.forEach((voice, idx) => {
                        assetsForSheet.push({
                            projectId: p.id,
                            assetType: 'voice',
                            index: idx,
                            name: voice.name,
                            mimeType: voice.type,
                            data: voice.data
                        });
                    });
                    // Add music
                    p.data.music.forEach((music, idx) => {
                        assetsForSheet.push({
                            projectId: p.id,
                            assetType: 'music',
                            index: idx,
                            name: music.name,
                            mimeType: music.type,
                            data: music.data
                        });
                    });
                });
                
                // Save to Google Sheets via Apps Script
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: JSON.stringify({ 
                        action: 'saveData',
                        projects: projectsForSheet,
                        assets: assetsForSheet
                    }),
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8'
                    }
                });
                
                const result = await response.json();
                
                if(result.success) {
                    showNotification('‚úì D·ªØ li·ªáu ƒë√£ l∆∞u l√™n Google Sheet', 'success');
                    console.log('Data saved:', projectsForSheet.length, 'projects,', assetsForSheet.length, 'assets');
                } else {
                    throw new Error(result.error || 'L·ªói kh√¥ng x√°c ƒë·ªãnh');
                }
            } catch(e) {
                console.error('Error saving:', e);
                showNotification('‚úó L·ªói khi l∆∞u: ' + e.message, 'error');
            }
        }

        async function loadFromGoogleSheets() {
            try {
                showNotification('‚ü≥ ƒêang t·∫£i t·ª´ Google Sheet...', 'info');
                
                const response = await fetch(APPS_SCRIPT_URL + '?action=loadData', {
                    method: 'GET'
                });
                
                const result = await response.json();
                
                if(result.success && result.projects && result.projects.length > 0) {
                    // Reconstruct projects with assets
                    projects = result.projects.map(projRow => {
                        // Get all assets for this project
                        const projectAssets = result.assets.filter(a => a.projectId === projRow.id);
                        
                        return {
                            id: projRow.id,
                            title: projRow.title,
                            created: projRow.created,
                            isComplete: projRow.isComplete,
                            data: {
                                sourceLink: projRow.sourceLink,
                                sourceNote: projRow.sourceNote,
                                transcript: projRow.transcript,
                                aiScript: projRow.aiScript,
                                sentToCapcut: projRow.sentToCapcut,
                                images: projectAssets.filter(a => a.assetType === 'image').map(a => ({
                                    name: a.name,
                                    type: a.mimeType,
                                    data: a.data
                                })),
                                voice: projectAssets.filter(a => a.assetType === 'voice').map(a => ({
                                    name: a.name,
                                    type: a.mimeType,
                                    data: a.data
                                })),
                                music: projectAssets.filter(a => a.assetType === 'music').map(a => ({
                                    name: a.name,
                                    type: a.mimeType,
                                    data: a.data
                                }))
                            }
                        };
                    });
                    
                    renderProjectList();
                    loadProject(projects[0].id);
                    showNotification('‚úì ƒê√£ t·∫£i d·ªØ li·ªáu t·ª´ Google Sheet', 'success');
                    return true;
                }
                
                showNotification('‚Ñπ Ch∆∞a c√≥ d·ªØ li·ªáu tr√™n Google Sheet', 'info');
                return false;
            } catch(e) {
                console.error('Error loading:', e);
                showNotification('‚úó L·ªói khi t·∫£i: ' + e.message, 'error');
                return false;
            }
        }

        function showNotification(message, type) {
            // Create a temporary notification
            const notif = document.createElement('div');
            notif.className = `fixed top-4 right-4 px-4 py-3 rounded-lg text-sm font-medium text-white z-50 ${
                type === 'success' ? 'bg-accentTertiary' :
                type === 'error' ? 'bg-red-500' :
                'bg-accentPrimary'
            }`;
            notif.innerText = message;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.style.opacity = '0';
                notif.style.transition = 'opacity 0.3s';
                setTimeout(() => notif.remove(), 300);
            }, 3000);
        }

        // --- CORE FUNCTIONS ---

        function renderProjectList() {
            const listEl = document.getElementById('project-list');
            const countAll = document.getElementById('count-all');
            const countActive = document.getElementById('count-active');
            const countDone = document.getElementById('count-done');
            
            listEl.innerHTML = '';
            
            let activeCount = 0;
            let doneCount = 0;

            projects.forEach(p => {
                if(p.isComplete) doneCount++; else activeCount++;

                const el = document.createElement('div');
                const isActive = p.id === activeProjectId;
                
                // Calculate progress roughly based on filled fields
                const progress = calculateProgress(p);
                
                el.className = `p-3 rounded-lg border cursor-pointer transition group relative ${isActive ? 'bg-slate-800 border-accentPrimary' : 'bg-panelDark border-borderDark hover:border-slate-600'}`;
                el.onclick = () => loadProject(p.id);

                el.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-bold text-slate-200 text-xs truncate w-40 group-hover:text-accentPrimary transition">${p.title}</h4>
                        ${p.isComplete 
                            ? '<span class="material-symbols-outlined text-accentTertiary text-[14px]">check_circle</span>' 
                            : `<span class="text-[10px] font-mono text-slate-500">${progress}%</span>`
                        }
                    </div>
                    <div class="flex items-center gap-2">
                        <!-- Tiny indicators for stages -->
                        <div class="flex gap-1">
                            <div class="w-1.5 h-1.5 rounded-full ${p.data.sourceLink ? 'bg-blue-500' : 'bg-slate-700'}" title="Source"></div>
                            <div class="w-1.5 h-1.5 rounded-full ${p.data.aiScript ? 'bg-blue-500' : 'bg-slate-700'}" title="Script"></div>
                            <div class="w-1.5 h-1.5 rounded-full ${p.data.voice.length > 0 ? 'bg-orange-500' : 'bg-slate-700'}" title="Voice"></div>
                            <div class="w-1.5 h-1.5 rounded-full ${p.data.images.length > 0 ? 'bg-pink-500' : 'bg-slate-700'}" title="Images"></div>
                        </div>
                        <span class="text-[10px] text-slate-600 ml-auto">${new Date(p.created).toLocaleDateString('vi-VN')}</span>
                    </div>
                    ${isActive ? '<div class="absolute left-0 top-3 bottom-3 w-1 bg-accentPrimary rounded-r"></div>' : ''}
                `;
                listEl.appendChild(el);
            });

            countAll.innerText = projects.length;
            countActive.innerText = activeCount;
            countDone.innerText = doneCount;
        }

        function calculateProgress(p) {
            let score = 0;
            if(p.data.sourceLink) score += 20;
            if(p.data.transcript) score += 10;
            if(p.data.aiScript) score += 20;
            if(p.data.images.length > 0) score += 15;
            if(p.data.voice.length > 0) score += 15;
            if(p.data.music.length > 0) score += 10;
            if(p.data.sentToCapcut) score += 10;
            return Math.min(100, score);
        }

        function createNewProject() {
            const newId = Date.now().toString();
            const newProj = {
                id: newId,
                title: `Project M·ªõi ${projects.length + 1}`,
                created: Date.now(),
                isComplete: false,
                data: {
                    sourceLink: '', 
                    sourceNote: '',
                    transcript: '', 
                    aiScript: '',
                    images: [], 
                    voice: [], 
                    music: [],
                    sentToCapcut: false
                }
            };
            projects.unshift(newProj);
            renderProjectList();
            loadProject(newId);
            saveToGoogleSheets(); // Auto-save new project
        }

        function loadProject(id) {
            activeProjectId = id;
            const p = projects.find(proj => proj.id === id);
            if(!p) return;

            // DEBUG: Log the project data
            console.log('Loading project:', p);
            console.log('Transcript value:', p.data.transcript);

            // UI Switch
            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('workspace').classList.remove('hidden');
            
            renderProjectList(); // To update active highlight

            // Populate Header
            document.getElementById('ws-project-title').value = p.title;
            document.getElementById('ws-project-id').innerText = `ID: #${String(p.id).slice(-6)}`;
            document.getElementById('ws-status-indicator').className = `w-3 h-3 rounded-full ${p.isComplete ? 'bg-accentTertiary' : 'bg-accentSecondary animate-pulse'}`;
            
            // Populate Fields
            // Source Link
            document.getElementById('link-source').value = p.data.sourceLink || '';
            document.getElementById('note-source').value = p.data.sourceNote || '';
            updateSourceLink(p.data.sourceLink || '');
            
            // Script
            document.getElementById('text-transcript').value = p.data.transcript || '';
            document.getElementById('text-ai').value = p.data.aiScript || '';
            document.getElementById('status-dot-script').className = `status-dot ${p.data.aiScript ? 'status-filled' : 'status-empty'}`;

            // Assets - Render Lists
            renderAssetList('images', p.data.images, 'image');
            renderAssetList('voice', p.data.voice, 'audiotrack');
            renderAssetList('music', p.data.music, 'music_note');

            // Final
            document.getElementById('check-sent').checked = p.data.sentToCapcut;
            updateCompleteButton(p.isComplete);
            updateProgressText(p);

            // Bind Title Change Listener
            document.getElementById('ws-project-title').oninput = (e) => {
                p.title = e.target.value;
                renderProjectList();
                saveToGoogleSheets(); // Auto-save title change
            };
        }

        function updateSourceLink(value) {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            
            p.data.sourceLink = value;
            saveToGoogleSheets();
            
            // Update status
            const statusEl = document.getElementById('video-status');
            const iconEl = document.getElementById('status-icon-source');
            
            if(value && value.trim()) {
                statusEl.innerText = '‚úì Link ƒë√£ l∆∞u - Click "M·ªü Video" ƒë·ªÉ xem';
                statusEl.className = 'text-[10px] text-accentTertiary text-center';
                if(iconEl) {
                    iconEl.innerText = 'check_circle';
                    iconEl.classList.add('text-green-500');
                }
            } else {
                statusEl.innerText = 'Ch∆∞a c√≥ link video';
                statusEl.className = 'text-[10px] text-slate-600 text-center';
                if(iconEl) {
                    iconEl.innerText = 'radio_button_unchecked';
                    iconEl.classList.remove('text-green-500');
                }
            }
        }

        function openVideoLink() {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p || !p.data.sourceLink) {
                showNotification('‚úó Ch∆∞a c√≥ link video', 'error');
                return;
            }
            
            window.open(p.data.sourceLink, '_blank');
            showNotification('‚úì ƒêang m·ªü video...', 'success');
        }

        function clearVideoLink() {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            
            p.data.sourceLink = '';
            document.getElementById('link-source').value = '';
            updateSourceLink('');
            saveToGoogleSheets();
            showNotification('‚úì ƒê√£ x√≥a link', 'success');
        }

        function openDownSub() {
            window.open('https://downsub.com/', '_blank');
            showNotification('‚úì ƒêang m·ªü DownSub.com...', 'success');
        }

        function openDownSubWithLink() {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p || !p.data.sourceLink) {
                showNotification('‚úó Vui l√≤ng d√°n link video tr∆∞·ªõc', 'error');
                return;
            }
            
            const videoUrl = p.data.sourceLink.trim();
            
            // Copy link to clipboard
            const temp = document.createElement('textarea');
            temp.value = videoUrl;
            document.body.appendChild(temp);
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            
            // Open DownSub
            window.open('https://downsub.com/', '_blank');
            showNotification(`‚úì Link video ƒë√£ copy v√†o clipboard: ${videoUrl}\nD√°n v√†o DownSub ƒë·ªÉ t·∫£i subtitle`, 'success');
        }

        function triggerTextFileUpload() {
            document.getElementById('text-file-input').click();
        }

        function handleTextFileUpload(input) {
            const file = input.files[0];
            if(!file) return;
            
            // Check file type
            const validTypes = ['.txt', '.srt', '.vtt'];
            const fileName = file.name.toLowerCase();
            const isValid = validTypes.some(type => fileName.endsWith(type));
            
            if(!isValid) {
                showNotification('‚úó Ch·ªâ h·ªó tr·ª£ file .txt, .srt, .vtt', 'error');
                return;
            }
            
            showNotification('‚ü≥ ƒêang ƒë·ªçc file...', 'info');
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const text = e.target.result;
                document.getElementById('text-transcript').value = text;
                
                // L∆∞u ngay l·∫≠p t·ª©c khi load file (kh√¥ng debounce)
                const p = projects.find(proj => proj.id === activeProjectId);
                if(p) {
                    p.data.transcript = text;
                    saveToGoogleSheets();
                }
                
                showNotification(`‚úì ƒê√£ t·∫£i ${file.name} (${text.length} k√Ω t·ª±)`, 'success');
            };
            reader.onerror = () => {
                showNotification('‚úó L·ªói khi ƒë·ªçc file', 'error');
            };
            reader.readAsText(file, 'UTF-8');
            
            // Reset input
            input.value = '';
        }

        function autoSaveTranscript(value) {
            // C·∫≠p nh·∫≠t ngay trong memory
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            p.data.transcript = value;

            // H·ªßy timeout c≈©
            if(transcriptSaveTimeout) {
                clearTimeout(transcriptSaveTimeout);
            }

            // L∆∞u sau 1 gi√¢y kh√¥ng nh·∫≠p
            transcriptSaveTimeout = setTimeout(() => {
                saveToGoogleSheets();
                showNotification('‚úì ƒê√£ l∆∞u', 'success');
                transcriptSaveTimeout = null;
            }, 1000);
        }

        function updateData(key, value) {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            
            p.data[key] = value;
            
            // Auto-save to Google Sheets
            saveToGoogleSheets();
            
            // Side effects for visuals
            if(key === 'aiScript') {
                 document.getElementById('status-dot-script').className = `status-dot ${value ? 'status-filled' : 'status-empty'}`;
            }
            if(key === 'sentToCapcut' && value === true) {
                // optional auto-check logic
            }

            renderProjectList(); // Update progress bars in list
            updateProgressText(p);
        }

        // --- ASSET HANDLING (SIMULATED) ---

        function triggerFileUpload(type) {
            document.getElementById(`input-${type}`).click();
        }

        async function handleFileSelect(type, input) {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p || !input.files.length) return;

            if(type === 'source') {
                // Single file for source (video) - KH√îNG GI·ªöI H·∫†N SIZE
                const file = input.files[0];
                
                showNotification('‚ü≥ ƒêang x·ª≠ l√Ω video...', 'info');
                const base64 = await fileToBase64(file);
                p.data.sourceFile = {
                    name: file.name,
                    type: file.type,
                    data: base64
                };
                renderFilePreview('source', p.data.sourceFile);
                
                // L∆∞u ngay l·∫≠p t·ª©c l√™n Google Sheets
                saveToGoogleSheets();
                renderProjectList();
                updateProgressText(p);
            } else {
                // Multi files for assets
                const totalFiles = input.files.length;
                showNotification(`‚ü≥ ƒêang x·ª≠ l√Ω ${totalFiles} file(s)...`, 'info');
                const processedFiles = [];
                
                for(let i = 0; i < input.files.length; i++) {
                    const file = input.files[i];
                    
                    // For images: L∆∞u tr·ª±c ti·∫øp Base64 kh√¥ng n√©n
                    if(type === 'image') {
                        showNotification(`‚ü≥ ƒêang x·ª≠ l√Ω ·∫£nh ${i+1}/${totalFiles}: ${file.name}...`, 'info');
                        const base64 = await fileToBase64(file);
                        processedFiles.push({
                            name: file.name,
                            type: file.type,
                            data: base64
                        });
                    } 
                    // For audio: convert to base64 - KH√îNG GI·ªöI H·∫†N SIZE
                    else if(type === 'voice' || type === 'music') {
                        showNotification(`‚ü≥ ƒêang x·ª≠ l√Ω audio ${i+1}/${totalFiles}: ${file.name}...`, 'info');
                        const base64 = await fileToBase64(file);
                        processedFiles.push({
                            name: file.name,
                            type: file.type,
                            data: base64
                        });
                    }
                }
                
                // Add to project data
                if(type === 'image') p.data.images = [...p.data.images, ...processedFiles];
                if(type === 'voice') p.data.voice = [...p.data.voice, ...processedFiles];
                if(type === 'music') p.data.music = [...p.data.music, ...processedFiles];
                
                // Re-render the specific list
                const arrayName = type === 'image' ? 'images' : type; // mapping
                const iconName = type === 'image' ? 'image' : (type === 'voice' ? 'audiotrack' : 'music_note');
                renderAssetList(arrayName, p.data[arrayName], iconName);
                
                showNotification(`‚úì ƒê√£ x·ª≠ l√Ω ${processedFiles.length} file(s) - ƒêang l∆∞u l√™n Google Sheets...`, 'success');
                
                // L∆∞u ngay l·∫≠p t·ª©c l√™n Google Sheets
                saveToGoogleSheets();
                renderProjectList();
                updateProgressText(p);
            }

            input.value = ''; // reset input
        }

        // Convert file to Base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }



        function renderFilePreview(type, fileData) {
            const previewEl = document.getElementById(`preview-${type}`);
            const labelEl = document.getElementById(`label-${type}`);
            const iconEl = document.getElementById(`status-icon-${type}`);
            
            if(fileData) {
                previewEl.classList.remove('hidden');
                
                // Check if fileData is object with base64 or just string
                const fileName = typeof fileData === 'string' ? fileData : fileData.name;
                const base64Data = typeof fileData === 'object' ? fileData.data : null;
                const fileType = typeof fileData === 'object' ? fileData.type : '';
                
                if(base64Data) {
                    // Show actual image/video preview
                    if(fileType.startsWith('image/')) {
                        previewEl.style.backgroundImage = `url(${base64Data})`;
                        previewEl.style.backgroundSize = 'cover';
                        previewEl.style.backgroundPosition = 'center';
                        previewEl.innerHTML = `
                            <div class="w-full h-full flex items-end justify-between bg-gradient-to-t from-black/80 to-transparent p-2">
                                <button onclick="downloadSourceFile()" class="text-[10px] text-accentPrimary hover:text-white border border-accentPrimary/30 px-2 py-0.5 rounded bg-black/50">T·∫£i xu·ªëng</button>
                                <button onclick="removeFile('source')" class="text-[10px] text-red-400 hover:text-red-300 border border-red-500/30 px-2 py-0.5 rounded bg-black/50">X√≥a</button>
                            </div>
                        `;
                    } else if(fileType.startsWith('video/')) {
                        previewEl.style.backgroundImage = 'none';
                        previewEl.innerHTML = `
                            <video src="${base64Data}" class="w-full h-full object-cover" controls></video>
                            <div class="absolute bottom-2 right-2 flex gap-2">
                                <button onclick="downloadSourceFile()" class="text-[10px] text-accentPrimary hover:text-white border border-accentPrimary/30 px-2 py-0.5 rounded bg-black/50">T·∫£i xu·ªëng</button>
                                <button onclick="removeFile('source')" class="text-[10px] text-red-400 hover:text-red-300 border border-red-500/30 px-2 py-0.5 rounded bg-black/50">X√≥a</button>
                            </div>
                        `;
                    }
                } else {
                    // No base64, show placeholder
                    previewEl.style.backgroundImage = `linear-gradient(135deg, #1e293b 0%, #0f172a 100%)`;
                    previewEl.innerHTML = `
                        <div class="w-full h-full flex flex-col items-center justify-center bg-black/60 backdrop-blur-sm p-2 text-center">
                            <span class="material-symbols-outlined text-white mb-1">movie</span>
                            <span class="text-xs text-white font-mono break-all line-clamp-2">${fileName}</span>
                            ${fileData.error ? `<span class="text-[10px] text-red-400 mt-1">${fileData.error}</span>` : ''}
                            <button onclick="removeFile('source')" class="mt-2 text-[10px] text-red-400 hover:text-red-300 border border-red-500/30 px-2 py-0.5 rounded">X√≥a</button>
                        </div>
                    `;
                }
                if(iconEl) { iconEl.innerText = 'check_circle'; iconEl.classList.add('text-green-500'); }
            } else {
                previewEl.classList.add('hidden');
                previewEl.innerHTML = '';
                previewEl.style.backgroundImage = 'none';
                if(iconEl) { iconEl.innerText = 'radio_button_unchecked'; iconEl.classList.remove('text-green-500'); }
            }
        }

        function removeFile(type) {
            event.stopPropagation();
            const p = projects.find(proj => proj.id === activeProjectId);
            if(type === 'source') {
                p.data.sourceFile = null;
                renderFilePreview('source', null);
            }
            updateData('dummy', 'dummy');
        }

        function downloadSourceFile() {
            event.stopPropagation();
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p || !p.data.sourceFile || !p.data.sourceFile.data) return;
            
            downloadBase64File(p.data.sourceFile.data, p.data.sourceFile.name);
        }

        function downloadAsset(arrayName, index) {
            event.stopPropagation();
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            
            const asset = p.data[arrayName][index];
            if(!asset || !asset.data) return;
            
            downloadBase64File(asset.data, asset.name);
        }

        function downloadBase64File(base64Data, fileName) {
            // Create a temporary link element
            const link = document.createElement('a');
            link.href = base64Data;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('‚úì ƒêang t·∫£i xu·ªëng: ' + fileName, 'success');
        }

        function removeAsset(arrayName, index, typeForRender) {
            const p = projects.find(proj => proj.id === activeProjectId);
            p.data[arrayName].splice(index, 1);
            
            // Re-render
            const iconName = typeForRender === 'image' ? 'image' : (typeForRender === 'voice' ? 'audiotrack' : 'music_note');
            renderAssetList(arrayName, p.data[arrayName], iconName);
            
            // L∆∞u ngay l·∫≠p t·ª©c l√™n Google Sheets
            saveToGoogleSheets();
            renderProjectList();
            updateProgressText(p);
        }

        function renderAssetList(arrayName, files, icon) {
            // Note: arrayName corresponds to the data key (e.g., 'images', 'voice')
            // container ID is 'container-images' or 'container-voice'
            const containerName = arrayName === 'images' ? 'images' : arrayName;
            const container = document.getElementById(`container-${containerName}`);
            
            if(!files || files.length === 0) {
                container.innerHTML = `<div class="text-center py-8 text-xs text-slate-600 pointer-events-none">Ch∆∞a c√≥ file</div>`;
                return;
            }

            container.innerHTML = '';
            
            // If images, use grid layout, else list
            if(arrayName === 'images') {
                container.className = "grid grid-cols-3 gap-2 bg-bgDark rounded border border-slate-700 p-2 min-h-[120px]";
                files.forEach((f, idx) => {
                    const el = document.createElement('div');
                    el.className = "aspect-square bg-slate-800 rounded relative group overflow-hidden border border-slate-600";
                    
                    // Check if f is object with base64 or just string
                    const fileName = typeof f === 'string' ? f : f.name;
                    const base64Data = typeof f === 'object' ? f.data : null;
                    
                    if(base64Data) {
                        // Show actual image
                        el.style.backgroundImage = `url(${base64Data})`;
                        el.style.backgroundSize = 'cover';
                        el.style.backgroundPosition = 'center';
                        el.innerHTML = `
                            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/40 transition"></div>
                            <div class="absolute top-1 right-1 flex gap-1 opacity-0 group-hover:opacity-100 z-10">
                                <button onclick="downloadAsset('${arrayName}', ${idx})" class="w-6 h-6 bg-black/70 text-white rounded flex items-center justify-center hover:bg-accentPrimary transition" title="T·∫£i xu·ªëng">
                                    <span class="material-symbols-outlined text-sm">download</span>
                                </button>
                                <button onclick="removeAsset('${arrayName}', ${idx}, 'image')" class="w-6 h-6 bg-black/70 text-white rounded flex items-center justify-center hover:bg-red-500 transition" title="X√≥a">
                                    <span class="material-symbols-outlined text-sm">close</span>
                                </button>
                            </div>
                        `;
                    } else {
                        // No base64, show placeholder
                        el.innerHTML = `
                            <div class="absolute inset-0 flex items-center justify-center text-xs text-slate-500 break-all p-1 bg-gradient-to-br from-slate-700 to-slate-900">
                                ${fileName}
                            </div>
                            <button onclick="removeAsset('${arrayName}', ${idx}, 'image')" class="absolute top-1 right-1 w-5 h-5 bg-black/50 text-white rounded flex items-center justify-center hover:bg-red-500 transition opacity-0 group-hover:opacity-100">
                                <span class="material-symbols-outlined text-[10px]">close</span>
                            </button>
                        `;
                    }
                    container.appendChild(el);
                });
            } else {
                container.className = "bg-bgDark rounded border border-slate-700 p-2 min-h-[120px] space-y-2";
                files.forEach((f, idx) => {
                    const el = document.createElement('div');
                    el.className = "flex items-center justify-between bg-slate-800/50 p-2 rounded border border-slate-700 group hover:border-slate-500 transition";
                    
                    // Check if f is object or string
                    const fileName = typeof f === 'string' ? f : f.name;
                    const base64Data = typeof f === 'object' ? f.data : null;
                    
                    el.innerHTML = `
                        <div class="flex items-center gap-2 overflow-hidden flex-1">
                            <span class="material-symbols-outlined text-slate-400 text-sm">${icon}</span>
                            ${base64Data ? `<audio src="${base64Data}" controls class="h-8 flex-1"></audio>` : `<span class="text-xs text-slate-300 truncate font-mono">${fileName}</span>`}
                        </div>
                        <div class="flex gap-2">
                            ${base64Data ? `<button onclick="downloadAsset('${arrayName}', ${idx})" class="text-accentPrimary hover:text-accentPrimary/80 transition opacity-0 group-hover:opacity-100" title="T·∫£i xu·ªëng">
                                <span class="material-symbols-outlined text-sm">download</span>
                            </button>` : ''}
                            <button onclick="removeAsset('${arrayName}', ${idx}, '${arrayName}')" class="text-slate-500 hover:text-red-400 transition opacity-0 group-hover:opacity-100" title="X√≥a">
                                <span class="material-symbols-outlined text-sm">delete</span>
                            </button>
                        </div>
                    `;
                    container.appendChild(el);
                });
            }
        }

        // --- EXPORT SOURCE CODE FUNCTION ---
        function downloadSourceCode() {
            // Get the entire HTML of the current document
            // Note: This gets the current DOM state. 
            // If you want the original clean code, we'd need to fetch it or store it.
            // But getting current DOM is usually sufficient for a quick "save this app" feature.
            const htmlContent = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
            
            // Create a Blob
            const blob = new Blob([htmlContent], { type: 'text/html' });
            
            // Create a temporary link element
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'content-warehouse-app.html'; // Filename
            
            // Trigger download
            document.body.appendChild(a);
            a.click();
            
            // Cleanup
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
        }

        // --- UTILS ---

        function toggleComplete() {
            const p = projects.find(proj => proj.id === activeProjectId);
            if(!p) return;
            
            p.isComplete = !p.isComplete;
            updateCompleteButton(p.isComplete);
            renderProjectList();
            saveToGoogleSheets(); // Auto-save status change
            document.getElementById('ws-status-indicator').className = `w-3 h-3 rounded-full ${p.isComplete ? 'bg-accentTertiary' : 'bg-accentSecondary animate-pulse'}`;
        }

        function updateCompleteButton(isComplete) {
            const btn = document.getElementById('btn-complete');
            const txt = document.getElementById('btn-complete-text');
            
            if(isComplete) {
                btn.className = "px-6 py-2.5 rounded-lg font-bold text-sm transition flex items-center gap-2 bg-accentTertiary text-white shadow-lg shadow-emerald-500/20";
                txt.innerText = "ƒê√£ Ho√†n Th√†nh";
            } else {
                btn.className = "px-6 py-2.5 rounded-lg font-bold text-sm transition flex items-center gap-2 bg-slate-700 text-slate-400 hover:bg-slate-600";
                txt.innerText = "ƒê√°nh d·∫•u Ho√†n th√†nh";
            }
        }

        function updateProgressText(p) {
            const percent = calculateProgress(p);
            document.getElementById('ws-progress-text').innerText = `${percent}%`;
            document.getElementById('ws-progress-text').style.color = percent === 100 ? '#10b981' : 'white';
        }

        function deleteCurrentProject() {
            if(!confirm("B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a d·ª± √°n n√†y?")) return;
            projects = projects.filter(p => p.id !== activeProjectId);
            activeProjectId = null;
            document.getElementById('workspace').classList.add('hidden');
            document.getElementById('empty-state').classList.remove('hidden');
            renderProjectList();
            saveToGoogleSheets(); // Auto-save after deletion
        }

        function copyToClipboard(elementId) {
            const el = document.getElementById(elementId);
            el.select();
            document.execCommand('copy');
            // Visual feedback could go here
        }

        // Init
        async function initApp() {
            // Load from Google Sheets only
            const loaded = await loadFromGoogleSheets();
            
            // If no data on Google Sheets, start empty
            if(!loaded) {
                projects = [];
                renderProjectList();
            }
        }
        
        // Run initialization
        initApp();

    </script>

</body></html>